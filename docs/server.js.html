<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>server.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-app.html">app</a></li><li><a href="module-controller_error.html">controller/error</a><ul class='methods'><li data-type='method'><a href="module-controller_error.html#~getHome">getHome</a></li></ul></li><li><a href="module-controller_standart.html">controller/standart</a><ul class='methods'><li data-type='method'><a href="module-controller_standart.html#~getHome">getHome</a></li><li data-type='method'><a href="module-controller_standart.html#~getPage">getPage</a></li><li data-type='method'><a href="module-controller_standart.html#~getPage">getPage</a></li></ul></li><li><a href="module-controllers_users.html">controllers/users</a><ul class='methods'><li data-type='method'><a href="module-controllers_users.html#~deleteAccount">deleteAccount</a></li><li data-type='method'><a href="module-controllers_users.html#~getMe">getMe</a></li><li data-type='method'><a href="module-controllers_users.html#~getPage">getPage</a></li><li data-type='method'><a href="module-controllers_users.html#~getProfil">getProfil</a></li><li data-type='method'><a href="module-controllers_users.html#~incrementLoose">incrementLoose</a></li><li data-type='method'><a href="module-controllers_users.html#~incrementWin">incrementWin</a></li><li data-type='method'><a href="module-controllers_users.html#~login">login</a></li><li data-type='method'><a href="module-controllers_users.html#~logout">logout</a></li><li data-type='method'><a href="module-controllers_users.html#~signup">signup</a></li><li data-type='method'><a href="module-controllers_users.html#~updatePSWD">updatePSWD</a></li></ul></li><li><a href="module-middleware_cors.html">middleware/cors</a></li><li><a href="module-models_user.html">models/user</a><ul class='methods'><li data-type='method'><a href="module-models_user.html#.incrementLoose">incrementLoose</a></li><li data-type='method'><a href="module-models_user.html#.incrementWin">incrementWin</a></li></ul></li><li><a href="module-routes_error.html">routes/error</a></li><li><a href="module-routes_standard.html">routes/standard</a></li><li><a href="module-routes_users.html">routes/users</a></li><li><a href="module-server.html">server</a><ul class='methods'><li data-type='method'><a href="module-server.html#~errorHandler">errorHandler</a></li><li data-type='method'><a href="module-server.html#~normalizePort">normalizePort</a></li></ul></li><li><a href="module-socket.html">socket</a><ul class='methods'><li data-type='method'><a href="module-socket.html#~addClue">addClue</a></li><li data-type='method'><a href="module-socket.html#~addOrUpdatePlayer">addOrUpdatePlayer</a></li><li data-type='method'><a href="module-socket.html#~back">back</a></li><li data-type='method'><a href="module-socket.html#~back">back</a></li><li data-type='method'><a href="module-socket.html#~createNote">createNote</a></li><li data-type='method'><a href="module-socket.html#~createOrJoinRoom">createOrJoinRoom</a></li><li data-type='method'><a href="module-socket.html#~createRoom">createRoom</a></li><li data-type='method'><a href="module-socket.html#~disconnect">disconnect</a></li><li data-type='method'><a href="module-socket.html#~getClueIndex">getClueIndex</a></li><li data-type='method'><a href="module-socket.html#~getDateHours">getDateHours</a></li><li data-type='method'><a href="module-socket.html#~getPlayerIndex">getPlayerIndex</a></li><li data-type='method'><a href="module-socket.html#~getRoomIndex">getRoomIndex</a></li><li data-type='method'><a href="module-socket.html#~getTeam">getTeam</a></li><li data-type='method'><a href="module-socket.html#~intervalChrono">intervalChrono</a></li><li data-type='method'><a href="module-socket.html#~intervalRoom">intervalRoom</a></li><li data-type='method'><a href="module-socket.html#~message">message</a></li><li data-type='method'><a href="module-socket.html#~newId">newId</a></li><li data-type='method'><a href="module-socket.html#~penalty">penalty</a></li><li data-type='method'><a href="module-socket.html#~refreshPlayer">refreshPlayer</a></li><li data-type='method'><a href="module-socket.html#~removePlayer">removePlayer</a></li><li data-type='method'><a href="module-socket.html#~removeRoom">removeRoom</a></li><li data-type='method'><a href="module-socket.html#~start">start</a></li><li data-type='method'><a href="module-socket.html#~talkToRobot">talkToRobot</a></li><li data-type='method'><a href="module-socket.html#~teamReady">teamReady</a></li><li data-type='method'><a href="module-socket.html#~winGame">winGame</a></li></ul></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">server.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/****************************************************************************
  Nom ......... : server.js
  Rôle ........ : Fichier responsable de la création et de la gestion du serveur HTTP, définition du port d'écoute et gestion des erreurs.
  Auteurs ..... : Jeremy Fouquet, Thibaut Decressonniere
  Version ..... : V1.0 du 28/04/2023
  Licence ..... : réalisé dans le cadre du projet 'réalisation de programme'
*****************************************************************************/

/**
 * @module server
 * @description Fichier responsable de la création et de la gestion du serveur HTTP, définition du port d'écoute et gestion des erreurs.
 * @author Jeremy Fouquet, Thibaut Decressonniere
 * @requires http
 * @requires dotenv
 * @requires socketio
 * @requires ./app
 */

const http = require('http');
const app = require('./app');
require('dotenv').config();

/**
 * Normalise le port en base 10
 * @name normalizePort 
 * @param {String} val : valeur entrée par l'utilisateur, le .env ou la valeur par défaut
 * @function
 */
const normalizePort = val => {
  const port = parseInt(val, 10);

  if (isNaN(port)) {
    return val;
  }
  if (port >= 0) {
    return port;
  }
  return false;
};
const port = normalizePort(process.env.PORT || '3000');
app.set('port', port);

/**
 * Gestionnaire d'erreurs
 * @name errorHandler
 * @param {Object} error : l'erreur levée
 * @function
 * @throws {EACCES} si l'utilisateur n'a pas les droits d'accès
 * @throws {EADDRINUSE} si le port est déjà utilisé
 */
const errorHandler = error => {
  if (error.syscall !== 'listen') {
    throw error;
  }
  const address = server.address();
  const bind = typeof address === 'string' ? 'pipe ' + address : 'port: ' + port;
  switch (error.code) {
    case 'EACCES':
      console.error(bind + ' requires elevated privileges.');
      process.exit(1);
      break;
    case 'EADDRINUSE':
      console.error(bind + ' is already in use.');
      process.exit(1);
      break;
    default:
      throw error;
  }
};

const server = http.createServer(app);

server.on('error', errorHandler);

server.on('listening', () => {
  const address = server.address();
  const bind = typeof address === 'string' ? 'pipe ' + address : 'port ' + port;
  console.log('Listening on ' + bind);
});

const io = require('socket.io')(server, {
  cors: {origin : '*'}
});
// initialize socket module and pass it the io instance
require('./socket')(io);

server.listen(port);

module.exports = server;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Mon Jun 26 2023 23:01:00 GMT+0200 (heure d’été d’Europe centrale) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
